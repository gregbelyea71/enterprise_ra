# CHANGELOG

## v2.0.0

> 2021-08-06

-   (fix) Correctly handle prop `actions` when set to `false`

## v2.0.0

> 2021-08-04

-   (fix) **Breaking change**: Renamed `CreateResourceButton` to `CreateButton`

-   (feat) Add support for the `mutationMode` prop introduced in `react-admin@3.12.0`.

    The `undoable` prop is deprecated, use `mutationMode` instead. It accepts the following values: `pessimistic`, `optimistic`, and `undoable`. See react-admin documentation about [mutationMode](https://marmelab.com/react-admin/CreateEdit.html#mutationmode).

-   (feat) Add support for custom actions on `<EditableDatagrid>` through the `actions` prop.

For instance, you could provide your own `DeleteButton` with confirmation and undoable notification:

```tsx
import React from 'react';
import { List, TextField } from 'react-admin';
import {
    DeleteWithConfirmIconButton,
    EditableDatagrid,
    EditRowButton,
} from '@react-admin/ra-editable-datagrid';
import { ArtistForm } from './ArtistForm';

const CustomAction = () => (
    <>
        <EditRowButton />
        <DeleteWithConfirmIconButton mutationMode="undoable" />
    </>
);

const ArtistList = (props: ListProps) => (
    <List
        {...props}
        hasCreate
        sort={{ field: 'id', order: 'DESC' }}
        empty={false}
    >
        <EditableDatagrid
            actions={<CustomAction />}
            // The mutation mode is still applied to updates
            mutationMode="undoable"
            editForm={<ArtistForm />}
        >
            <TextField source="id" />
            <TextField source="firstname" />
            <TextField source="name" />
        </EditableDatagrid>
    </List>
);
```

## v1.3.5

> 2021-07-28

-   (fix) Ensure submitting on enter does not discard validation errors

## v1.3.4

> 2021-07-27

-   (fix) Update Delete Icon buttons to use ra-core hooks

## v1.3.3

> 2021-07-19

-   (fix) Fix creating a record fails when the Datagrid is empty

## v1.3.2

> 2021-07-16

-   (fix) Fix Edit button does not respond to click

## v1.3.1

> 2021-06-29

-   (fix) Update peer dependencies ranges (support react 17)

## v1.3.0

> 2021-06-14

-   (feat) Add support for side effects on `<RowForm>`.

You can now provide your own side effects in response to successful/failed update/creation in an `<EditableDatagrid>` by passing functions to the `onSuccess` or `onFailure` props:

```tsx
import {
    DateInput,
    SelectInput,
    TextField,
    TextInput,
    useNotify,
} from 'react-admin';
import {
    RowForm,
    RowFormProps,
    useEditRowContext,
    useCreateRowContext,
} from '@react-admin/ra-editable-datagrid';

const ArtistEditForm = (props: RowFormProps) => {
    const notify = useNotify();
    const { close } = useEditRowContext();

    const handleSuccess = response => {
        notify(
            `Artist ${response.data.name} ${response.data.firstName} has been updated`
        );
        close();
    };

    return (
        <RowForm onSuccess={handleSuccess} {...props}>
            <TextField source="id" />
            <TextInput source="firstname" validate={required()} />
            <TextInput source="name" validate={required()} />
            <DateInput source="dob" label="born" validate={required()} />
            <SelectInput
                source="prof"
                label="Profession"
                choices={professionChoices}
            />
        </RowForm>
    );
};

const ArtistCreateForm = props => {
    const notify = useNotify();
    const { close } = useCreateRowContext();

    const handleSuccess = response => {
        notify(
            `Artist ${response.data.name} ${response.data.firstName} has been added`
        );
        close();
    };

    return (
        <RowForm onSuccess={handleSuccess} {...props}>
            <TextInput source="firstname" validate={required()} />
            <TextInput source="name" validate={required()} />
            <DateInput source="dob" label="born" validate={required()} />
            <SelectInput
                source="prof"
                label="Profession"
                choices={professionChoices}
            />
        </RowForm>
    );
};
```

Note that we provide two additional side effects hooks: `useEditRowContext` and `useCloseCreateRow`, which allow you to close the form.

Besides, the `<RowForm>` also accepts a function for its `transform` prop, allowing you to alter the data before sending it to the dataProvider:

```tsx
const ArtistCreateForm = props => {
    const handleTransform = data => {
        return {
            ...data,
            fullName: `${data.firstName} ${data.name}`,
        };
    };

    return (
        <RowForm transform={handleTransform} {...props}>
            <TextInput source="firstname" validate={required()} />
            <TextInput source="name" validate={required()} />
            <DateInput source="dob" label="born" validate={required()} />
            <SelectInput
                source="prof"
                label="Profession"
                choices={professionChoices}
            />
        </RowForm>
    );
};
```

## v1.2.0

> 2021-05-17

-   (chore) Upgrade to react-admin 3.15
-   (feat) Ensure all components with custom styles are overridable through MUI theme by providing their key (`RaEditableDatagrid`, `RaEditableDatagridRow` and `RaRowForm`).

## v1.1.2

> 2021-05-11

-   Fix `<EditableDatagrid>` fails when wrapped

## v1.1.1

> 2020-11-03

-   Add the `noDelete` prop to `<EditableDatagrid>` to disable the inline Delete button

## v1.1.0

> 2020-10-05

-   Upgrade to react-admin `3.9`

## v1.0.4

> 2020-09-30

-   Update Readme

## v1.0.3

> 2020-09-17

-   (fix) Fix crash on row deletion and impossible row creation

## v1.0.2

> 2020-09-16

-   (deps) Upgrade dependencies

## v1.0.1

> 2020-09-07

-   (feat) Add support for `expand`

## v1.0.0

> 2020-08-05

-   First release
