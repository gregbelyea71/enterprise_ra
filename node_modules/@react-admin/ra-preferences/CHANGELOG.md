# CHANGELOG

## v1.3.7

> 2021-08-02

-   (fix) Fix warnings about keys when using `useSelectedColumns`.

## v1.3.6

> 2021-07-21

-   (fix) Fix preferences synchronization accross browser tabs.

## v1.3.5

> 2021-07-08

-   (fix) Fix handling of undefined values when setting preference on a key.

## v1.3.4

> 2021-06-29

-   (fix) Fix SidebarOpenPreferenceSync resets its value on each page load

## v1.3.3

> 2021-06-29

-   (fix) Update peer dependencies ranges (support react 17)

## v1.3.2

> 2021-06-24

-   (fix) Fix library exports (`<PreferencesContextProvider>` and related hooks)

## v1.3.1

> 2021-06-15

-   (fix) Fix regression in `usePreferences` preventing to set a preference value back to its default.

## v1.3.0

> 2021-05-25

-   (feat) Add optional synchronization of the preferences with the API.

To enable this feature, your dataProvider must have the following two methods:

-   `getPreferences()`: returns a promise which resolves to an object with the following shape: `{ data: preferences }`. Meant to read the user preferences on first load.

-   `setPreferences({ data, previousData })`: Called when users update their preferences, with `data` being the new preferences and `previousData` the preferences before the update. Must returns a promise which resolves to an object with the following shape: `{ data: preferences }`.

You must wrap your `Layout` inside a `<PreferencesContextProvider synchronize>`. Note that it accepts a `synchronize` prop which enable the synchronization of the preferences with the dataProvider.

```tsx
import { PreferencesContextProvider } from '@react-admin/ra-preferences';
import { Admin, Resource, Layout } from 'react-admin';

const MyLayout = ({ children, ...props }) => {
    const classes = useStyles();

    return (
        <PreferencesContextProvider synchronize>
            <Layout {...props}>{children}</Layout>
        </PreferencesContextProvider>
    );
};

const App = () => (
    <Admin dataProvider={dataProvider} layout={MyLayout}>
        <Resource name="posts" list={PostList} />
    </Admin>
);
```

## v1.2.6

> 2021-05-25

-   (fix) useSelectedColumns now filters out columns stored in preferences but not available anymore.

## v1.2.5

> 2021-04-26

-   (performances) Replace MUI boxes by div with styles.

## v1.2.4

> 2021-04-19

-   (fix) Fallback to inmemory storage when localstorage is unavailable

## v1.2.3

> 2021-02-01

-   (fix) Fix Fallback on default value in usePreferences

## v1.2.2

> 2021-01-22

-   (fix) Fix SidebarOpenPreferenceSync

## v1.2.1

> 2021-01-21

-   (fix) Fix usePreferences ignore falsy values
-   (fix) Fix SidebarOpenPreferenceSync initialization

## v1.2.0

> 2020-12-07

-   Add `<FilterWithSave>` component, to allow persisted queries in `<Filter>`
-   Add `<SavedQueriesList>` component, to allow persisted queries in `<FilterList>`
-   (fix) translate ToggleThemeButton tooltip

## v1.1.4

> 2020-11-17

-   (fix) Remove useless `defaultLanguage` prop in `<LanguageSwitcher>`

## v1.1.3

> 2020-11-06

-   (fix) Fix SelectColumnsMenu Unnecessary Props

## v1.1.2

> 2020-11-06

-   (fix) Fix SelectColumnsMenu Props Types

## v1.1.1

> 2020-10-31

-   (fix) `PreferenceBasedThemeProvider` passes a complete MuiTheme to `<Admin>` instead of a simple object

## v1.1.0

> 2020-10-05

-   Upgrade to react-admin `3.9`

## v1.0.2

> 2020-09-30

-   Update Readme

## v1.0.1

> 2020-09-16

-   (deps) Upgrade dependencies

## v1.0.0

> 2020-07-31

-   First release
